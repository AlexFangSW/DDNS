kind: pipeline
type: kubernetes
name: development-push

trigger:
  branch:
  - development
  event: 
  - push

steps:
- name: netshoot
  image: nicolaka/netshoot
  commands:
  - ip route
  - ip a
  - ping -c 3 google.com
  - curl -o cloudflare.zip https://proxy.golang.org/github.com/cloudflare/cloudflare-go/@v/v0.100.0.zip
  - ls

- name: docker
  image: plugins/docker
  settings:
    username:
      from_secret: docker-user
    password:
      from_secret: docker-password
    registry: docker.cloud.alexfangsw.com
    repo: docker.cloud.alexfangsw.com/infra/ddns
    mtu: 1450
    tags:
    - latest
    - development

# TODO: helm
